"use strict";(self.webpackChunkmedic_hospital_management=self.webpackChunkmedic_hospital_management||[]).push([[580],{2862:(t,e,s)=>{s.d(e,{Z:()=>r});var n=s(1519),a=s.n(n)()((function(t){return t[1]}));a.push([t.id,".styled-table[data-v-5555839c]{//font-family:sans-serif;border-collapse:collapse;font-size:1em;margin:0;min-width:100%;table-layout:fixed;width:100%}.styled-table thead tr[data-v-5555839c]{background-color:#009879;color:#fff;text-align:left}.styled-table td[data-v-5555839c],.styled-table th[data-v-5555839c]{padding:6px 10px}.styled-table tbody tr[data-v-5555839c]{//border-bottom:1px solid #ddd}.styled-table tbody tr td[data-v-5555839c]{border:1px solid #f3f3f3}.styled-table tbody tr[data-v-5555839c]:nth-of-type(2n){//background-color:#f3f3f3}.styled-table tbody tr.active-row[data-v-5555839c]{color:#009879;font-weight:700}",""]);const r=a},9580:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(6887);var n=s(1902);const a={props:{banks:{type:Array,default:function(){return[]}},detail:{required:!1,type:Object,default:function(){}}},data:function(){return{refundForm:new window.Form({ledger_id:"",date:"",comments:"",header_id:"",source:"4",bank_account_id:"",details:[]}),bills:[]}},methods:{getPatientBills:function(){var t=this,e=this;n.Z.findPatientBills(this.detail.hashid).then((function(s){var n=s.data;console.log(n),t.bills=n.bills.filter((function(t){return t.payment_id===e.detail.id})).map((function(t){return{id:t.id,description:t.description,total:t.total,selected:!1}}))})).catch()},setup:function(){this.refundForm.ledger_id=this.detail.invoice_id,this.getPatientBills()},cleanUp:function(){this.bills=[],this.refundForm.reset()},refundTransaction:function(){var t=this;this.bills.length?this.bills.find((function(t){return!0===t.selected}))?(this.refundForm.details=this.bills.filter((function(t){return!0===t.selected})),this.refundForm.post("/patient-billing/refund").then((function(){t.$toast.success("Payment Refunded"),t.$emit("bill:refunded"),t.$bvModal.hide("refund-modal")})).catch((function(){t.refundForm.processing=!1,t.$toast.error("Something went wrong")}))):this.$toast.error("Please select the bills"):this.$toast.error("Please select the bills")},toggleBulkReconcile:function(){var t=this;this.bills.length&&this.bills.forEach((function(e){e.selected=t.$refs.bulkBill.checked}))}}};var r=s(3379),l=s.n(r),o=s(2862),i={insert:"head",singleton:!1};l()(o.Z,i);o.Z.locals;const d=(0,s(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("div",[e("b-modal",{attrs:{id:"refund-modal",title:"Refund Cash","title-class":"font-18","no-close-on-backdrop":"","no-close-on-esc":"","no-enforce-focus":!0,"hide-header-close":"","content-class":"bg-white rounded-3","body-class":"px-4","modal-class":"modal-blur",size:"lg","footer-class":"d-flex justify-content-between"},on:{shown:t.setup,hidden:t.cleanUp},scopedSlots:t._u([{key:"modal-footer",fn:function(s){var n=s.cancel;return[e("button",{staticClass:"btn btn-light",attrs:{disabled:t.refundForm.processing},on:{click:n}},[t._v("\n        Close\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.refundForm.processing},on:{click:t.refundTransaction}},[t._v("\n        Refund\n      ")])]}}])},[e("div",{staticClass:"row gx-4"},[e("div",{staticClass:"col-xl-6"},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:""}},[t._v("Date")]),t._v(" "),e("date-picker",{attrs:{"max-date":new Date,value:t.refundForm.date},on:{"on-change":function(e,s){t.refundForm.date=s}}}),t._v(" "),t.refundForm.hasError("date")?e("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.refundForm.getError("date"))}}):t._e()],1)]),t._v(" "),e("div",{staticClass:"col-xl-6"},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:"bank_account_id"}},[t._v("Refund Method")]),t._v(" "),e("v-select",{attrs:{id:"bank_account_id",options:t.banks,label:"name",reduce:function(t){return t.id},clearable:!1},model:{value:t.refundForm.bank_account_id,callback:function(e){t.$set(t.refundForm,"bank_account_id",e)},expression:"refundForm.bank_account_id"}}),t._v(" "),t.refundForm.hasError("bank_account_id")?e("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.refundForm.getError("bank_account_id"))}}):t._e()],1)])]),t._v(" "),e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:"comments"}},[t._v("Reason")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.refundForm.comments,expression:"refundForm.comments"}],staticClass:"form-control",attrs:{id:"comments",required:"",type:"text",placeholder:"Please leave a brief description detailing your reason for refunding"},domProps:{value:t.refundForm.comments},on:{input:function(e){e.target.composing||t.$set(t.refundForm,"comments",e.target.value)}}}),t._v(" "),t.refundForm.hasError("comments")?e("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.refundForm.getError("comments"))}}):t._e(),t._v(" "),t.refundForm.hasError("ledger_id")?e("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.refundForm.getError("ledger_id"))}}):t._e()]),t._v(" "),e("div",{staticClass:"mb-3"},[e("h1",{staticClass:"h2 fw-bold mb-0 pb-0"},[t._v("\n        Patient Bills\n      ")]),t._v(" "),e("span",{staticClass:"text-muted"},[t._v("Please check the bills to fund")]),t._v(" "),e("br"),t._v(" "),e("span",{staticClass:"text-danger small"},[t._v("selected bills will be deleted, Payment will be refunded")])]),t._v(" "),e("table",{staticClass:"styled-table table-hover"},[e("thead",[e("tr",[e("th",{staticClass:"text-center",staticStyle:{width:"5%"}},[e("input",{ref:"bulkBill",attrs:{type:"checkbox"},on:{input:t.toggleBulkReconcile}})]),t._v(" "),e("th",{staticClass:"ps-3",staticStyle:{width:"85%"}},[t._v("\n            Description\n          ")]),t._v(" "),e("th",{staticClass:"pe-3 text-end",staticStyle:{width:"15%"}},[t._v("\n            Amount\n          ")])])]),t._v(" "),e("tbody",t._l(t.bills,(function(s,n){return e("tr",{key:n},[e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.bills[n].selected,expression:"bills[index].selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.bills[n].selected)?t._i(t.bills[n].selected,null)>-1:t.bills[n].selected},on:{change:function(e){var s=t.bills[n].selected,a=e.target,r=!!a.checked;if(Array.isArray(s)){var l=t._i(s,null);a.checked?l<0&&t.$set(t.bills[n],"selected",s.concat([null])):l>-1&&t.$set(t.bills[n],"selected",s.slice(0,l).concat(s.slice(l+1)))}else t.$set(t.bills[n],"selected",r)}}})]),t._v(" "),e("td",{staticClass:"ps-3"},[t._v("\n            "+t._s(t.bills[n].description)+"\n          ")]),t._v(" "),e("td",{staticClass:"pe-3 text-end"},[t._v("\n            "+t._s(t.bills[n].total)+"\n          ")])])})),0)]),t._v(" "),t.refundForm.hasError("details")?e("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.refundForm.getError("details"))}}):t._e(),t._v(" "),t.refundForm.processing?e("div",{staticClass:"progress mb-2"},[e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar progress-bar-indeterminate bg-green"})])]):t._e()]),t._v(" "),e("b-modal",{attrs:{id:"refund-modal-form","title-class":"font-18","no-close-on-backdrop":"","no-close-on-esc":"","no-enforce-focus":!0,"content-class":"rounded-lg","hide-header":""},scopedSlots:t._u([{key:"modal-footer",fn:function(s){var n=s.cancel;return[e("b-overlay",{attrs:{show:t.refundForm.processing,"spinner-small":""}},[e("button",{staticClass:"btn btn-light mr-3",attrs:{disabled:t.refundForm.processing},on:{click:n}},[t._v("\n          Close\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-danger shadow-sm",attrs:{form:"refundForm",disabled:t.refundForm.processing},on:{click:t.refundTransaction}},[t._v("\n          Refund\n        ")])])]}}])},[e("form",{attrs:{id:"refundForm"},on:{submit:function(e){return e.preventDefault(),t.refundTransaction.apply(null,arguments)}}})])],1)}),[],!1,null,"5555839c",null).exports}}]);