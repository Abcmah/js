"use strict";(self.webpackChunkmedic_hospital_management=self.webpackChunkmedic_hospital_management||[]).push([[613],{7203:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(1519),l=i.n(n)()((function(t){return t[1]}));l.push([t.id,".styled-table[data-v-33215770]{border-collapse:collapse;font-family:sans-serif;font-size:1em;margin:0;min-width:100%}.styled-table thead tr[data-v-33215770]{background-color:#009879;color:#fff;text-align:left}.styled-table td[data-v-33215770],.styled-table th[data-v-33215770]{padding:6px 10px}.styled-table tbody tr[data-v-33215770]{//border-bottom:1px solid #ddd}.styled-table tbody tr td[data-v-33215770]{border:1px solid #f3f3f3}.styled-table tbody tr[data-v-33215770]:nth-of-type(2n){//background-color:#f3f3f3}.styled-table tbody tr.active-row[data-v-33215770]{color:#009879;font-weight:700}",""]);const a=l},8613:(t,e,i)=>{i.r(e),i.d(e,{default:()=>u});var n=i(4801),l=i(4850);function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MMM Do, yyyy";return(0,l.Z)(t,e)}const o={filters:{toMoneyFormat:function(t){return t?(0,n.p)(t).toFormat("0,0.00"):0}},props:{invoice:{type:Object,required:!0}},data:function(){return{form:new window.Form({ledger_id:this.invoice.id,item_id:null,quantity:1,unit_price:0,date:a(new Date,"yyyy-MM-dd"),comments:""}),patientBills:[],tableFields:[{key:"description",label:"Description"},{key:"total",label:"Amount"}],totalBill:0,selectedBills:[]}},computed:{billsTable:function(){return this.$refs.billsTable}},methods:{applyCreditNote:function(){var t=this,e=this.patientBills.filter((function(t){return t.credit_note>0}));if(e.length){var i=e.map((function(t){return{date:t.date,unit_price:-1*t.credit_note,item_id:t.item_id,description:"Credit Note: "+t.description,quantity:1,instructions:"Credit Note"}}));this.$httpClient.post("/patient-bills",{ledger_id:this.invoice.id,items:i}).then((function(){t.$emit("bill:added"),t.$bvModal.hide("cnote-modal")})).catch((function(e){t.$toast.error(e.message)}))}},cleanup:function(){this.form.reset(),this.selectedCalculation=0,this.selectedPercentage=0,this.totalBill=0},findPatientBills:function(){var t=this;this.$httpClient.get("/patient-billing/patient-bills/"+this.invoice.hashid).then((function(e){var i=e.data;t.patientBills=i.bills.filter((function(t){return!1===t.paid&&!1===t.is_inventory&&!1===t.is_payment&&!1===t.is_discount&&t.total>0})).map((function(t){return{item_id:t.item_id,description:t.description,unit_price:t.unit_price,total:t.total,credit_note:0,quantity:1,instruction:"Credit Note"}}))})).catch()}}};var s=i(3379),r=i.n(s),d=i(7203),c={insert:"head",singleton:!1};r()(d.Z,c);d.Z.locals;const u=(0,i(1900).Z)(o,(function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"cnote-modal","hide-header-close":"","title-class":"font-18","no-close-on-backdrop":"",size:"xl",lazy:"",scrollable:""},on:{shown:t.findPatientBills,hidden:t.cleanup},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v("\n    Credit Note\n  ")]},proxy:!0},{key:"modal-footer",fn:function(i){var n=i.cancel;return[e("button",{staticClass:"btn me-4",attrs:{disabled:t.form.processing},on:{click:function(t){return t.preventDefault(),n.apply(null,arguments)}}},[t._v("\n      Close\n    ")]),t._v(" "),e("button",{staticClass:"btn btn-success me-2",attrs:{disabled:t.form.processing,type:"submit"},on:{click:function(e){return e.preventDefault(),t.applyCreditNote.apply(null,arguments)}}},[t._v("\n      Submit\n    ")])]}}])},[t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-12"},[e("table",{staticClass:"styled-table"},[e("thead",[e("tr",[e("th",{staticClass:"ps-3",staticStyle:{width:"60%"}},[t._v("\n              Description\n            ")]),t._v(" "),e("th",{staticClass:"text-end pe-3",staticStyle:{width:"10%"}},[t._v("\n              Amount\n            ")]),t._v(" "),e("th",{staticStyle:{width:"30%"}},[t._v("\n              Credit Note\n            ")])])]),t._v(" "),e("tbody",t._l(t.patientBills,(function(i,n){return e("tr",{key:n},[e("td",{staticClass:"ps-3"},[t._v("\n              "+t._s(i.description)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-end pe-3"},[t._v("\n              "+t._s(t._f("toMoneyFormat")(i.total))+"\n            ")]),t._v(" "),e("td",[e("medic-money",{attrs:{value:t.patientBills[n].credit_note},on:{input:function(e){t.patientBills[n].credit_note=e}}})],1)])})),0)])])])])}),[],!1,null,"33215770",null).exports}}]);