"use strict";(self.webpackChunkmedic_hospital_management=self.webpackChunkmedic_hospital_management||[]).push([[453],{4457:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(9301),r=n(4155),o="/api/v1";const a={findAllMedia:function(t,e){return i.Z.get(r.env.VUE_APP_BACKEND_URL+"/media/"+t+"/"+e)},downloadMedia:function(t){return i.Z.get(r.env.VUE_APP_BACKEND_URL+"/media/"+t,{responseType:"blob"})},deleteMedia:function(t){return i.Z.delete(r.env.VUE_APP_BACKEND_URL+"/media/"+t)},findAllHeaders:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/invoices",t)},findHeaderById:function(t){return i.Z.get("/invoices/"+t)},createHeader:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("header",t,e)},findAllDetail:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("detail",t)},findDetailById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("detail",t,e)},createDetail:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("detail",t,e)},createAddress:function(t){return jsonApi.create("address",t)},updateAddress:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("address",t,e)},findAddressById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("address",t,e)},updateSettings:function(t){return jsonApi.update("setting",t)},findAllSettings:function(){return jsonApi.findAll("setting")},updateSetting:function(t){return jsonApi.update("setting",t)},findSettingById:function(t){return jsonApi.find("setting",t)},findAllVisitTypes:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/visits",t)},updateOrganization:function(t){return i.Z.put("/organizations/"+t.id+"/",t)},updateInstitutionPhoto:function(t){return t.post(o+"/organization/update_logo")},findOrganization:function(){return i.Z.get("/organizations")},searchDepartments:function(t){return i.Z.get(o+"/departments?name="+t)},findAllDepartments:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/departments",t)},findDepartmentById:function(t){return i.Z.get("/departments/"+t)},createDepartment:function(t){return i.Z.post("/departments",t)},updateDepartment:function(t){return i.Z.patch("/departments/".concat(t.id),t)},findIdentification:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("identification",t,e||{})},createIdentification:function(t){return i.Z.post("/identifications",t)},updateIdentification:function(t){return i.Z.patch("/identifications/"+t.id,t)},deleteIdentification:function(t){return jsonApi.destroy("identification",t)},findWardById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.Z.get("/wards/"+t,e)},findAllWards:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/wards",t)},createWard:function(t){return i.Z.post("/wards",t)},updateWard:function(t){return i.Z.patch("/wards/".concat(t.id),t)},deleteWard:function(t){return i.Z.delete(o+"/wards/"+t)},getBranches:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/branches",t)},findBranchById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("branch",t,e)},createBranch:function(t){return i.Z.post("/branches",t)},updateBranch:function(t){return i.Z.patch("/branches/".concat(t.id),t)},getWards:function(t){return i.Z.get(o+"/wards?branchId="+t)},getStores:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("store",t)},searchStore:function(t){return i.Z.get(o+"/stores?name="+t)},findAllItemTypes:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/item_types",t)},createItemType:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("items_type",t,e)},updateItemType:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("items_type",t,e)},findAllItemsGroups:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/item_groups",t)},createItemGroup:function(t){return i.Z.post("/item_groups",t)},updateItemGroup:function(t){return i.Z.patch("/item_groups/"+t.id,t)},deleteItemGroup:function(t){return i.Z.delete("/item_groups/"+t)},findAllItems:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/datatable/products",t)},findItemById:function(t){return i.Z.get("/items/"+t)},findAllPricesList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/price_lists",t)},createPriceList:function(t){return i.Z.post("/prices_lists",t)},updatePriceList:function(t){return i.Z.patch("/prices_lists/"+t.id,t)},deletePriceList:function(t){return i.Z.delete("/prices_lists/"+t)},findAllItemsAssociation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("items_association",t)},deleteItemsAssociation:function(t){return jsonApi.destroy("items_association",t)},createItemsAssociation:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("items_association",t,e)},findAllDailyCharges:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("daily_charge",t)},createDailyCharge:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("daily_charge",t,e)},updateDailyCharge:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("daily_charge",t,e)},deleteDailyCharge:function(t){return jsonApi.destroy("daily_charge",t)},searchUOM:function(t){return i.Z.get(o+"/unit_of_measure?filter=".concat(t))},createItem:function(t){return i.Z.post("/items",t)},updateItem:function(t){return i.Z.patch("/items/".concat(t.id),t)},deleteItem:function(t){return i.Z.delete(o+"/items/"+t)},findAllFormulations:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/formulations",t)},createFormulation:function(t){return i.Z.post("/formulations",t)},updateFormulation:function(t){return i.Z.patch("/formulations/".concat(t.id),t)},createRoute:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("route",t,e)},updateRoute:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("route",t,e)},findAllRoute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("route",t)},createProductRoute:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("items_route",t,e)},deleteProductRoute:function(t){return jsonApi.destroy("items_route",t)},findAllUOM:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/uoms",t)},createUOM:function(t){return i.Z.post("/unit_of_measurements",t)},updateUOM:function(t){return i.Z.patch("/unit_of_measurements/".concat(t.id),t)},findAllItemsAssignment:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("item_assignment",t)},createItemAssignment:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("item_assignment",t,e)},deleteItemAssignment:function(t){return jsonApi.destroy("item_assignment",t)},updateItemAssignment:function(t){return t.put(o+"/items/"+t.item_id+"/assignments/"+t.id)},createItemAssociation:function(t){return t.post(o+"/items/"+t.item_id+"/associations")},deleteItemAssociation:function(t,e){return i.Z.delete(o+"/items/"+t+"/associations/"+e)},updateItemAssociation:function(t){return t.put(o+"/items/"+t.item_id+"/associations/"+t.id)},deleteFormulation:function(t){return i.Z.delete(o+"/formulations/"+t.id)},getUOM:function(){return i.Z.get(o+"/unit_of_measure")},deleteUOM:function(t){return i.Z.delete(o+"/unit_of_measure/"+t.id)},createReligion:function(t){return jsonApi.create("religion",{name:t.name})},updateReligion:function(t){return jsonApi.update("religion",{id:t.id,name:t.name})},deleteReligion:function(t){return jsonApi.destroy("religion",t)},findAllReligion:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("religion",t)},findStoreById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("store",t,e)},findAllStore:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/stores",t)},createStore:function(t){return i.Z.post("/stores",t)},updateStore:function(t){return i.Z.patch("/stores/".concat(t.id),t)},findAllPrefixes:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("prefix",t)},findPrefixById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("prefix",t,e)},createPrefix:function(t){return jsonApi.create("prefix",t,t)},updatePrefix:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("prefix",t,e)},getWArdBeds:function(t){return i.Z.get(o+"/beds?ward_id="+t)},findAllBeds:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("bed",t)},createBed:function(t){return i.Z.post("/beds",t)},updateBed:function(t){return i.Z.patch("/beds/".concat(t.id),t)},findBedById:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("bed",t,e)},deleteBed:function(t){return i.Z.delete(o+"/beds/"+t)},searchCountries:function(t){return i.Z.get(o+"/countries?name=".concat(t))},findAllCountries:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("country",t)},findAllCurrencies:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("currency",t)},getRelationships:function(){return i.Z.get(o+"/relationships")},findAllIdentifications:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/identifications",t)},findAllGender:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/genders",t)},findAllProductType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/item_types",t)},createProductType:function(t){return t.post(o+"/item-types")},updateProductType:function(t){return t.put(o+"/item-types/"+t.id)},deleteProductType:function(t){return i.Z.delete(o+"/item-types/"+t)},createProductGroup:function(t){return t.post(o+"/item-groups")},updateProductGroup:function(t){return t.put(o+"/item-groups/"+t.id)},deleteProductGroup:function(t){return i.Z.delete(o+"/item-groups/"+t)},findAllReligions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/religions",t)},findReligionById:function(t){return i.Z.get("/religions/"+t)},findAllBloodGroups:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("bloodGroup",t)},findAllMaritalStatuses:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/marital_statuses",t)},findAllRelationships:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("relationship",t)}}},8453:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});var i=n(4457),r=n(4801);const o={filters:{toMoneyFormat:function(t){return t?(0,r.p)(t).toFormat("0,0.00"):0}},props:{invoice:{type:Object,required:!0}},data:function(){return{form:new window.Form({ledger_id:this.invoice.id,item:null,unit_price:0,items:[]}),discountItems:[],discountCalculations:[{name:"Fixed Amount",id:0},{name:"Percentage of Bill",id:1}],selectedCalculation:0,selectedPercentage:0}},computed:{billsTable:function(){return this.$refs.billsTable},netBalance:function(){if(0===this.selectedCalculation)return Number.parseInt(.01*this.invoice.balance)-Number.parseInt(this.form.unit_price);var t=.01*this.selectedPercentage,e=.01*this.invoice.balance*t;return this.form.unit_price=Math.round(e),.01*this.invoice.balance-Math.round(e)}},methods:{applyDiscount:function(){if(this.form.item){if(0===this.selectedCalculation&&(this.form.unit_price>this.totalBill||0===this.form.unit_price))this.$toast.error("Discount cannot be zero or greater than total bill");else if(1===this.selectedCalculation){if(this.selectedPercentage>100||this.selectedPercentage<=0)return void this.$toast.warning("The discount rate exceeds the allowed range");this.saveDiscount()}}else this.$toast.warning("Please select the discount type")},saveDiscount:function(){var t=this;this.form.items.push({item_id:this.form.item.id,description:this.form.item.name,unit_price:this.form.unit_price,quantity:1}),this.form.post("/patient-bills").then((function(){t.$toast.success("Discount Applied"),t.$emit("bill:added"),t.$bvModal.hide("discount-modal")})).catch()},setup:function(){this.findAllDiscountProducts()},cleanup:function(){this.form.reset(),this.selectedCalculation=0,this.selectedPercentage=0,this.totalBill=0},findAllDiscountProducts:function(){var t=this;i.Z.findAllItems({params:{filter:{discount:!0}}}).then((function(e){var n=e.data;t.discountItems=n.data})).catch((function(t){console.error(t)}))}}};const a=(0,n(1900).Z)(o,(function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"discount-modal","title-class":"font-18","no-close-on-backdrop":"","footer-class":"d-flex justify-content-between bg-muted-lt border-top","content-class":"bg-white rounded-3","body-class":"px-4","modal-class":"modal-blur",title:"Discount Allowed","hide-header-close":"","no-close-on-esc":"","no-enforce-focus":""},on:{shown:t.setup,hidden:t.cleanup},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var i=n.cancel;return[e("button",{staticClass:"btn btn-light",attrs:{disabled:t.form.processing},on:{click:function(t){return t.preventDefault(),i.apply(null,arguments)}}},[t._v("\n      Close\n    ")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{disabled:t.form.processing,type:"submit"},on:{click:function(e){return e.preventDefault(),t.applyDiscount.apply(null,arguments)}}},[t._v("\n      Give Discount\n    ")])]}}])},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:""}},[t._v("Discount type")]),t._v(" "),e("v-select",{attrs:{id:"account_id",options:t.discountItems,label:"name",reduce:function(t){return t},clearable:!1},model:{value:t.form.item,callback:function(e){t.$set(t.form,"item",e)},expression:"form.item"}}),t._v(" "),t.form.hasError("item_id")?e("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.form.getError("item_id"))}}):t._e()],1),t._v(" "),e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:""}},[t._v("Discount Method")]),t._v(" "),e("div",[e("label",{staticClass:"form-check form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedCalculation,expression:"selectedCalculation"}],staticClass:"form-check-input",attrs:{type:"radio",checked:""},domProps:{value:0,checked:t._q(t.selectedCalculation,0)},on:{change:function(e){t.selectedCalculation=0}}}),t._v(" "),e("span",{staticClass:"form-check-label"},[t._v("Fixed Amount ")])]),t._v(" "),e("label",{staticClass:"form-check form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedCalculation,expression:"selectedCalculation"}],staticClass:"form-check-input",attrs:{type:"radio"},domProps:{value:1,checked:t._q(t.selectedCalculation,1)},on:{change:function(e){t.selectedCalculation=1}}}),t._v(" "),e("span",{staticClass:"form-check-label"},[t._v("Percentage")])])])]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-4"},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:""}},[t._v("Bill")]),t._v(" "),e("medic-money",{attrs:{disabled:!0,value:.01*t.invoice.balance}})],1)]),t._v(" "),0===t.selectedCalculation?e("div",{staticClass:"col-xl-4"},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:""}},[t._v("Amount")]),t._v(" "),e("medic-money",{on:{input:function(e){t.form.unit_price=e}}})],1)]):t._e(),t._v(" "),1===t.selectedCalculation?e("div",{staticClass:"col-xl-4"},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:"disc_rate"}},[t._v("Rate (%)")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedPercentage,expression:"selectedPercentage"}],staticClass:"form-control",attrs:{id:"disc_rate",type:"number",min:"1",max:"100"},domProps:{value:t.selectedPercentage},on:{input:function(e){e.target.composing||(t.selectedPercentage=e.target.value)}}}),t._v(" "),e("span",{staticClass:"text-indigo small"},[t._v("Kes "+t._s(t._f("toMoneyFormat")(t.form.unit_price)))])])]):t._e(),t._v(" "),e("div",{staticClass:"col-xl-4"},[e("div",{staticClass:"form-group mb-4"},[e("label",{staticClass:"form-label",attrs:{for:""}},[t._v("Net Amount")]),t._v(" "),e("medic-money",{attrs:{value:t.netBalance,disabled:""}})],1)])])])}),[],!1,null,null,null).exports}}]);