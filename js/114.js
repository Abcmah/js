"use strict";(self.webpackChunkmedic_hospital_management=self.webpackChunkmedic_hospital_management||[]).push([[114],{4457:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(9301),r=n(4155),o="/api/v1";const s={findAllMedia:function(e,t){return i.Z.get(r.env.VUE_APP_BACKEND_URL+"/media/"+e+"/"+t)},downloadMedia:function(e){return i.Z.get(r.env.VUE_APP_BACKEND_URL+"/media/"+e,{responseType:"blob"})},deleteMedia:function(e){return i.Z.delete(r.env.VUE_APP_BACKEND_URL+"/media/"+e)},findAllHeaders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/invoices",e)},findHeaderById:function(e){return i.Z.get("/invoices/"+e)},createHeader:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("header",e,t)},findAllDetail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("detail",e)},findDetailById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("detail",e,t)},createDetail:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("detail",e,t)},createAddress:function(e){return jsonApi.create("address",e)},updateAddress:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("address",e,t)},findAddressById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("address",e,t)},updateSettings:function(e){return jsonApi.update("setting",e)},findAllSettings:function(){return jsonApi.findAll("setting")},updateSetting:function(e){return jsonApi.update("setting",e)},findSettingById:function(e){return jsonApi.find("setting",e)},findAllVisitTypes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/visits",e)},updateOrganization:function(e){return i.Z.put("/organizations/"+e.id+"/",e)},updateInstitutionPhoto:function(e){return e.post(o+"/organization/update_logo")},findOrganization:function(){return i.Z.get("/organizations")},searchDepartments:function(e){return i.Z.get(o+"/departments?name="+e)},findAllDepartments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/departments",e)},findDepartmentById:function(e){return i.Z.get("/departments/"+e)},createDepartment:function(e){return i.Z.post("/departments",e)},updateDepartment:function(e){return i.Z.patch("/departments/".concat(e.id),e)},findIdentification:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("identification",e,t||{})},createIdentification:function(e){return i.Z.post("/identifications",e)},updateIdentification:function(e){return i.Z.patch("/identifications/"+e.id,e)},deleteIdentification:function(e){return jsonApi.destroy("identification",e)},findWardById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.Z.get("/wards/"+e,t)},findAllWards:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/wards",e)},createWard:function(e){return i.Z.post("/wards",e)},updateWard:function(e){return i.Z.patch("/wards/".concat(e.id),e)},deleteWard:function(e){return i.Z.delete(o+"/wards/"+e)},getBranches:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/branches",e)},findBranchById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("branch",e,t)},createBranch:function(e){return i.Z.post("/branches",e)},updateBranch:function(e){return i.Z.patch("/branches/".concat(e.id),e)},getWards:function(e){return i.Z.get(o+"/wards?branchId="+e)},getStores:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("store",e)},searchStore:function(e){return i.Z.get(o+"/stores?name="+e)},findAllItemTypes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/item_types",e)},createItemType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("items_type",e,t)},updateItemType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("items_type",e,t)},findAllItemsGroups:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/item_groups",e)},createItemGroup:function(e){return i.Z.post("/item_groups",e)},updateItemGroup:function(e){return i.Z.patch("/item_groups/"+e.id,e)},deleteItemGroup:function(e){return i.Z.delete("/item_groups/"+e)},findAllItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/datatable/products",e)},findItemById:function(e){return i.Z.get("/items/"+e)},findAllPricesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/price_lists",e)},createPriceList:function(e){return i.Z.post("/prices_lists",e)},updatePriceList:function(e){return i.Z.patch("/prices_lists/"+e.id,e)},deletePriceList:function(e){return i.Z.delete("/prices_lists/"+e)},findAllItemsAssociation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("items_association",e)},deleteItemsAssociation:function(e){return jsonApi.destroy("items_association",e)},createItemsAssociation:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("items_association",e,t)},findAllDailyCharges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("daily_charge",e)},createDailyCharge:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("daily_charge",e,t)},updateDailyCharge:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("daily_charge",e,t)},deleteDailyCharge:function(e){return jsonApi.destroy("daily_charge",e)},searchUOM:function(e){return i.Z.get(o+"/unit_of_measure?filter=".concat(e))},createItem:function(e){return i.Z.post("/items",e)},updateItem:function(e){return i.Z.patch("/items/".concat(e.id),e)},deleteItem:function(e){return i.Z.delete(o+"/items/"+e)},findAllFormulations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/formulations",e)},createFormulation:function(e){return i.Z.post("/formulations",e)},updateFormulation:function(e){return i.Z.patch("/formulations/".concat(e.id),e)},createRoute:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("route",e,t)},updateRoute:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("route",e,t)},findAllRoute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("route",e)},createProductRoute:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("items_route",e,t)},deleteProductRoute:function(e){return jsonApi.destroy("items_route",e)},findAllUOM:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/uoms",e)},createUOM:function(e){return i.Z.post("/unit_of_measurements",e)},updateUOM:function(e){return i.Z.patch("/unit_of_measurements/".concat(e.id),e)},findAllItemsAssignment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("item_assignment",e)},createItemAssignment:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.create("item_assignment",e,t)},deleteItemAssignment:function(e){return jsonApi.destroy("item_assignment",e)},updateItemAssignment:function(e){return e.put(o+"/items/"+e.item_id+"/assignments/"+e.id)},createItemAssociation:function(e){return e.post(o+"/items/"+e.item_id+"/associations")},deleteItemAssociation:function(e,t){return i.Z.delete(o+"/items/"+e+"/associations/"+t)},updateItemAssociation:function(e){return e.put(o+"/items/"+e.item_id+"/associations/"+e.id)},deleteFormulation:function(e){return i.Z.delete(o+"/formulations/"+e.id)},getUOM:function(){return i.Z.get(o+"/unit_of_measure")},deleteUOM:function(e){return i.Z.delete(o+"/unit_of_measure/"+e.id)},createReligion:function(e){return jsonApi.create("religion",{name:e.name})},updateReligion:function(e){return jsonApi.update("religion",{id:e.id,name:e.name})},deleteReligion:function(e){return jsonApi.destroy("religion",e)},findAllReligion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("religion",e)},findStoreById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("store",e,t)},findAllStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/stores",e)},createStore:function(e){return i.Z.post("/stores",e)},updateStore:function(e){return i.Z.patch("/stores/".concat(e.id),e)},findAllPrefixes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("prefix",e)},findPrefixById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("prefix",e,t)},createPrefix:function(e){return jsonApi.create("prefix",e,e)},updatePrefix:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.update("prefix",e,t)},getWArdBeds:function(e){return i.Z.get(o+"/beds?ward_id="+e)},findAllBeds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("bed",e)},createBed:function(e){return i.Z.post("/beds",e)},updateBed:function(e){return i.Z.patch("/beds/".concat(e.id),e)},findBedById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jsonApi.find("bed",e,t)},deleteBed:function(e){return i.Z.delete(o+"/beds/"+e)},searchCountries:function(e){return i.Z.get(o+"/countries?name=".concat(e))},findAllCountries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("country",e)},findAllCurrencies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("currency",e)},getRelationships:function(){return i.Z.get(o+"/relationships")},findAllIdentifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/identifications",e)},findAllGender:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/genders",e)},findAllProductType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/item_types",e)},createProductType:function(e){return e.post(o+"/item-types")},updateProductType:function(e){return e.put(o+"/item-types/"+e.id)},deleteProductType:function(e){return i.Z.delete(o+"/item-types/"+e)},createProductGroup:function(e){return e.post(o+"/item-groups")},updateProductGroup:function(e){return e.put(o+"/item-groups/"+e.id)},deleteProductGroup:function(e){return i.Z.delete(o+"/item-groups/"+e)},findAllReligions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/religions",e)},findReligionById:function(e){return i.Z.get("/religions/"+e)},findAllBloodGroups:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("bloodGroup",e)},findAllMaritalStatuses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.Z.get("/marital_statuses",e)},findAllRelationships:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jsonApi.findAll("relationship",e)}}},8114:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});n(1902),n(6887);var i=n(4457);n(3279);const r={props:{items:{type:Array,default:function(){return[]}},invoice:{type:Object,required:!0},patientVisit:{type:Object,required:!0}},data:function(){return{fields:[{name:"date",title:"Date",callback:this.$options.filters.date_DATE_MONTH_YEAR},{name:"description",title:"Procedure"},{name:"unit_price",title:"Price",titleClass:"ps-1",dataClass:"ps-1",callback:function(e){return.01*e}},{name:"__slot:actions",dataClass:"text-right"}],bills:[],form:new window.Form({id:null,item_id:"",comments:"",ledger_id:"",date:(new Date).toISOString().slice(0,10),quantity:1,unit_price:1,items:[]}),invoices:[],productPrice:0}},computed:{vuetable:function(){return this.$refs.table.$refs.vuetable},url:function(){return"/procedures/"+this.invoice.patient_id},procedureItems:function(){return this.items.filter((function(e){return e.procedure}))}},watch:{"form.item_id":function(e){e&&this.findProductPriceSetup(e)}},methods:{findProductPriceSetup:function(e){var t=this.items.find((function(t){return t.id===e}));0===this.invoice.cash_credit&&(this.form.unit_price=t.cash_price?.01*t.cash_price.charge_value:0),1===this.invoice.cash_credit&&(this.form.unit_price=t.scheme_price?.01*t.scheme_price.charge_value:0)},submitProcedureRequest:function(){var e=this;this.form.processing=!0,this.form.ledger_id=this.invoice.id;var t=this,n=this.items.find((function(e){return e.id===t.form.item_id}));if(0!==this.invoice.cash_credit||n.cash_price)if(1!==this.invoice.cash_credit||n.scheme_price){var i={description:n.name,item_id:this.form.item_id,quantity:1,unit_price:this.form.unit_price,ledger_id:this.form.ledger_id};this.form.items.push(i),this.form.post("/patient-bills").then((function(){e.$toast.success("Procedure has been requested"),e.$bvModal.hide("procedure-modal")})).catch()}else this.$toast.error("The procedure billing price has not been set");else this.$toast.error("The procedure billing price has not been set")},deleteProcedure:function(e){var t=this;e.paid?this.$toast.error("The procedure has been paid for. You cannot paid transactions"):this.$toast.question("Do you want to continue?","Deleting Procedure!").then((function(){t.$httpClient.post("/bills/reverse",{comments:"Deleted by doctor",detail_id:e.id,ledger_id:e.ledger_id,source:"1"}).then((function(){t.vuetable.reload(),t.$toast.success("The procedure has been deleted")})).catch((function(){t.$toast.error("The procedure could not be deleted. Please try again later")}))}))},cleanUp:function(){this.vuetable.reload(),this.form.reset()},findProcedureForVisit:function(){this.vuetable.reload()},findAllInvoices:function(){var e=this;i.Z.findAllHeaders({sort:"-date",page:{size:2e4},filter:{patient_id:this.invoice.patient_id}}).then((function(t){var n=t.data;e.invoices=n})).catch()}}};const o=(0,n(1900).Z)(r,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"card rounded-3"},[t("div",{staticClass:"card-header"},[t("h2",[e._v("Procedures")]),e._v(" "),t("div",{staticClass:"card-actions"},[null===e.invoice.processed_at?t("button",{directives:[{name:"b-modal",rawName:"v-b-modal:procedure-modal",arg:"procedure-modal"}],staticClass:"btn btn-outline-primary"},[t("i",{staticClass:"uil uil-plus me-1"}),e._v("\n          New Procedure\n        ")]):e._e()])]),e._v(" "),t("vue-table",{ref:"table",attrs:{"api-url":e.url,fields:e.fields},scopedSlots:e._u([{key:"actions",fn:function(n){return[null===e.invoice.processed_at?t("div",{staticClass:"dropdown"},[t("button",{staticClass:"btn dropdown-toggle align-text-top",attrs:{"data-bs-toggle":"dropdown"}},[e._v("\n            Menu\n          ")]),e._v(" "),t("div",{staticClass:"dropdown-menu dropdown-menu-end"},[t("a",{staticClass:"dropdown-item text-danger",attrs:{href:"#"},on:{click:function(t){return e.deleteProcedure(n.rowData)}}},[t("i",{staticClass:"uil uil-trash-alt me-2"}),e._v(" Delete\n            ")])])]):e._e()]}}])})],1),e._v(" "),t("b-modal",{attrs:{id:"procedure-modal",title:"Procedure Form","no-close-on-backdrop":"","hide-header-close":"","content-class":"rounded-3 bg-white","body-class":"px-4","modal-class":"modal-blur","footer-class":"d-flex justify-content-between border-top bg-light"},on:{hidden:e.cleanUp},scopedSlots:e._u([{key:"modal-footer",fn:function(n){var i=n.cancel;return[t("button",{staticClass:"btn btn-light me-2",attrs:{disabled:e.form.processing},on:{click:i}},[e._v("\n        Close\n      ")]),e._v(" "),t("button",{staticClass:"btn btn-primary",attrs:{form:"form",type:"submit",disabled:e.form.processing}},[e._v("\n        Request Procedure\n      ")])]}}])},[t("form",{attrs:{id:"form"},on:{submit:function(t){return t.preventDefault(),e.submitProcedureRequest.apply(null,arguments)}}},[t("div",{staticClass:"form-group mb-4"},[t("label",{staticClass:"form-label"},[e._v("Procedure")]),e._v(" "),t("v-select",{attrs:{options:e.procedureItems,label:"name",clearable:!1,reduce:function(e){return e.id}},scopedSlots:e._u([{key:"selected-option",fn:function(n){return[t("div",[t("div",{staticClass:"font-weight-medium"},[e._v("\n                "+e._s(n.name)+"\n              ")]),e._v(" "),0===e.invoice.cash_credit?t("div",{staticClass:"text-primary small"},[e._v("\n                KES "+e._s(e._f("toMoneyFormat")(n.cash_price?.01*n.cash_price.charge_value:0))+"\n              ")]):t("div",{staticClass:"text-primary small"},[e._v("\n                KES "+e._s(e._f("toMoneyFormat")(n.scheme_price?.01*n.scheme_price.charge_value:0))+"\n              ")])])]}}]),model:{value:e.form.item_id,callback:function(t){e.$set(e.form,"item_id",t)},expression:"form.item_id"}}),e._v(" "),e.form.hasError("item_id")?t("span",{staticClass:"text-danger",domProps:{textContent:e._s(e.form.getError("item_id"))}}):e._e()],1),e._v(" "),t("div",{staticClass:"mb-3"},[t("label",{staticClass:"form-label",attrs:{for:""}},[e._v("Comments "),t("small",[e._v("(optional)")])]),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.comments,expression:"form.comments"}],staticClass:"form-control",attrs:{id:"note",type:"text",name:"comments"},domProps:{value:e.form.comments},on:{input:function(t){t.target.composing||e.$set(e.form,"comments",t.target.value)}}}),e._v(" "),e.form.errors.has("comments")?t("span",{staticClass:"text-danger",domProps:{textContent:e._s(e.form.errors.get("comments"))}}):e._e()])])])],1)}),[],!1,null,null,null).exports}}]);