"use strict";(self.webpackChunkmedic_hospital_management=self.webpackChunkmedic_hospital_management||[]).push([[844],{3844:(t,s,e)=>{e.r(s),e.d(s,{default:()=>o});var a=e(1902),i=e(3279);const n={props:{visit:{type:Object,required:!0}},data:function(){return{fields:[{name:"created_at",title:"Date",titleClass:"ps-3",dataclass:"ps-3",width:"10%",callback:this.$options.filters.date_DATE_MONTH_YEAR},{name:"icd.description",title:"Diagnosis",titleClass:"ps-3",dataclass:"ps-3 text-truncate",width:"40%"},{name:"icd.code",title:"Code",titleClass:"ps-3",dataclass:"ps-3",width:"20%"},{name:"user.name",title:"Written By",titleClass:"ps-3",dataclass:"ps-3 ps-3 text-truncate",width:"20%"},{name:"__slot:actions"}],moreParams:{filter:{patient_id:this.visit.patient_id}},diagnoses:[],icd10:[],form:new window.Form({patient_visit_id:this.visit.id,provisional_diagnosis:"",icd_id:"",remarks:""}),viewForm:!1,patientVisitRecords:this.patientVisits}},computed:{vuetable:function(){return this.$refs.table.$refs.vuetable}},watch:{"moreParams.filter.patient_visit_id":function(t){t&&this.vuetable.refresh()}},methods:{createDiagnosis:function(){var t=this;this.form.post("/diagnosis").then((function(){t.$bvModal.hide("diagnosis-modal"),t.$toast.success("Diagnosis added"),t.vuetable.refresh()})).catch()},deleteDiagnosis:function(t){var s=this;this.$toast.question("Are you sure","Delete Diagnosis").then((function(){a.Z.deleteDiagnosis(t.id).then((function(){s.$toast.success("The diagnosis has been deleted"),s.vuetable.refresh()})).catch((function(){s.$toast.error("Sorry! The diagnosis could not be deleted")}))}))},getICD10:function(){var t=this;this.$httpClient.get("/icd_codes").then((function(s){var e=s.data;t.icd10=e.data})).catch()},onDiseaseSearch:function(t,s){t&&(s(!0),this.searchDisease(t,s,this))},searchDisease:e.n(i)()((function(t,s,e){e.$httpClient.get("/icd_codes",{params:{filter:{search:t}}}).then((function(t){var a=t.data;e.icd10=a.data,s(!1)})).catch((function(){s(!1)}))}),1e3)}};const o=(0,e(1900).Z)(n,(function(){var t=this,s=t._self._c;return s("div",[s("div",{staticClass:"card rounded-3 mt-3"},[s("div",{staticClass:"card-header"},[s("h2",{staticClass:"page-title"},[t._v("\n        Diagnoses\n      ")]),t._v(" "),s("div",{staticClass:"card-actions"},[s("button",{directives:[{name:"b-modal",rawName:"v-b-modal:diagnosis-modal",arg:"diagnosis-modal"}],staticClass:"btn btn-outline-primary",attrs:{disabled:t.visit.posted_at}},[t._v("\n          Diagnose\n        ")])])]),t._v(" "),s("VueTable",{ref:"table",attrs:{"api-url":"/diagnosis",fields:t.fields,"append-params":t.moreParams},scopedSlots:t._u([{key:"actions",fn:function(e){return[s("button",{staticClass:"btn btn-white py-1",on:{click:function(s){return t.deleteDiagnosis(e.rowData)}}},[s("i",{staticClass:"uil uil-trash-alt text-danger me-1"})])]}}])})],1),t._v(" "),s("b-modal",{attrs:{id:"diagnosis-modal",title:"Diagnosis Form","title-class":"font-18","no-close-on-backdrop":"","hide-header-close":"","footer-class":"d-flex justify-content-end bg-light-alpha border-top","content-class":"rounded-3 bg-white",size:"lg"},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var a=e.cancel;return[s("button",{staticClass:"btn me-auto",attrs:{type:"button",disabled:t.form.processing},on:{click:function(t){return t.preventDefault(),a.apply(null,arguments)}}},[t._v("\n        Dismiss\n      ")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.form.processing},on:{click:t.createDiagnosis}},[t._v("\n        Submit\n      ")])]}}])},[s("form",{attrs:{id:"diagnosisForm"},on:{submit:function(s){return s.preventDefault(),t.createDiagnosis.apply(null,arguments)},keydown:function(s){return t.form.errors.clear(s.target.name)}}},[s("div",{staticClass:"mb-3"},[s("label",{staticClass:"form-label",attrs:{for:"icd10_id"}},[t._v("Diagnosis ")]),t._v(" "),s("v-select",{attrs:{id:"icd10_id",label:"description",options:t.icd10,reduce:function(t){return t.id},clearable:!1,filterable:!1},on:{search:t.onDiseaseSearch},scopedSlots:t._u([{key:"no-options",fn:function(e){var a=e.search;return[e.searching?[t._v("\n              No results found for "),s("em",[t._v(t._s(a))])]:s("em",{staticStyle:{opacity:"0.5"}},[t._v("Type ICD1O Code or disease name to search")])]}},{key:"option",fn:function(e){return[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-truncate"},[t._v("\n                  "+t._s(e.description)+"\n                ")]),t._v(" "),s("div",{staticClass:"text-primary"},[t._v("\n                  "+t._s(e.code)+"\n                ")])])])]}},{key:"selected-option",fn:function(e){return[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-truncate"},[t._v("\n                  "+t._s(e.description)+"\n                ")]),t._v(" "),s("div",{staticClass:"text-primary"},[t._v("\n                  "+t._s(e.code)+"\n                ")])])])]}}]),model:{value:t.form.icd_id,callback:function(s){t.$set(t.form,"icd_id",s)},expression:"form.icd_id"}}),t._v(" "),t.form.hasError("icd_id")?s("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.form.getError("icd_id"))}}):t._e()],1),t._v(" "),s("div",{staticClass:"mb-3"},[s("label",{staticClass:"form-label",attrs:{for:""}},[t._v(" Remarks "),s("small",[t._v("(optional)")])]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.remarks,expression:"form.remarks"}],staticClass:"form-control",attrs:{rows:"5"},domProps:{value:t.form.remarks},on:{input:function(s){s.target.composing||t.$set(t.form,"remarks",s.target.value)}}}),t._v(" "),t.form.hasError("remarks")?s("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.form.getError("remarks"))}}):t._e()])])])],1)}),[],!1,null,null,null).exports}}]);